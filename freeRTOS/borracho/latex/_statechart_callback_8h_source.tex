\doxysection{Statechart\+Callback.\+h}
\hypertarget{_statechart_callback_8h_source}{}\label{_statechart_callback_8h_source}\index{src/StatechartCallback.h@{src/StatechartCallback.h}}
\mbox{\hyperlink{_statechart_callback_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#ifndef\ STATECHARTCALLBACK\_H}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ STATECHARTCALLBACK\_H}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{comment}{//\ Includes\ do\ projeto}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_statechart_8h}{src-\/gen/Statechart.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <Arduino.h>}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{comment}{//\ DisplayOLED}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <Wire.h>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <Adafruit\_GFX.h>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <Adafruit\_SSD1306.h>}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{comment}{//\ Matrix4x4}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ <Keypad.h>}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{comment}{//\ FreeRTOS\ Headers}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}freertos/FreeRTOS.h"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}freertos/queue.h"{}}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{comment}{//\ -\/-\/-\/\ DEFINES\ DO\ HARDWARE\ -\/-\/-\/}}
\DoxyCodeLine{00033\ \textcolor{comment}{//\ Parâmetros\ do\ DisplayOLED}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#define\ SCREEN\_WIDTH\ 128}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ SCREEN\_HEIGHT\ 64}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ OLED\_RESET\ -\/1}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{comment}{//\ -\/-\/-\/\ DEFINES\ ESPECÍFICAS\ DO\ PWM\ LEDC\ (ESP32)\ -\/-\/-\/}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ LEDC\_CHANNEL\_PWM\_HEATER\ 0}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{//\ Mapeamento\ do\ teclado\ 4x4}}
\DoxyCodeLine{00042\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{byte}\ ROWS\ =\ 4;}
\DoxyCodeLine{00043\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{byte}\ COLS\ =\ 4;}
\DoxyCodeLine{00044\ \textcolor{keywordtype}{char}\ keys[ROWS][COLS]\ =\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \{\textcolor{charliteral}{'1'},\ \textcolor{charliteral}{'2'},\ \textcolor{charliteral}{'3'},\ \textcolor{charliteral}{'A'}\},}
\DoxyCodeLine{00046\ \ \ \ \ \{\textcolor{charliteral}{'4'},\ \textcolor{charliteral}{'5'},\ \textcolor{charliteral}{'6'},\ \textcolor{charliteral}{'B'}\},}
\DoxyCodeLine{00047\ \ \ \ \ \{\textcolor{charliteral}{'7'},\ \textcolor{charliteral}{'8'},\ \textcolor{charliteral}{'9'},\ \textcolor{charliteral}{'C'}\},}
\DoxyCodeLine{00048\ \ \ \ \ \{\textcolor{charliteral}{'*'},\ \textcolor{charliteral}{'0'},\ \textcolor{charliteral}{'\#'},\ \textcolor{charliteral}{'D'}\}\};}
\DoxyCodeLine{00049\ \textcolor{keywordtype}{byte}\ rowPins[ROWS]\ =\ \{13,\ 12,\ 14,\ 27\};}
\DoxyCodeLine{00050\ \textcolor{keywordtype}{byte}\ colPins[COLS]\ =\ \{26,\ 25,\ 33,\ 32\};}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{comment}{//\ -\/-\/-\/\ ENUMS\ E\ ESTRUTURAS\ DE\ COMANDO\ -\/-\/-\/}}
\DoxyCodeLine{00056\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22}{DisplayCommandType}}}
\DoxyCodeLine{00057\ \{}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a732e21a594c56f6f697ea63b11632b7e}{CMD\_CLEAR\_DISPLAY}},\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a3d08f50be96d71a458162333bf33c60f}{CMD\_SHOW\_STATE\_INFO}},\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00060\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22ab45b5c5cd6dcf255514bb199504797e8}{CMD\_SHOW\_MAIN\_MENU\_SCREEN}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a9b9ccbe68655c10897a3ded78fc3cec8}{CMD\_SHOW\_STARTUP\_MESSAGE}},\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a38415e178049b3abad6d027af5041cba}{CMD\_SHOW\_RECIPES\_LIST}},\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00063\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a83c456024f50d58dd3211c82a6760dc9}{CMD\_SHOW\_RECIPE\_DETAILS\_SCREEN}},\ \ }
\DoxyCodeLine{00064\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22aee41de1a1b27e052cb15e5cc762b14e8}{CMD\_PRINT\_KEYPAD\_INPUT}},\ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22ac7e9bde2dc20904ed5ccdae878cdebbb}{CMD\_SHOW\_PROCESS\_STATUS\_SCREEN}},\ \ }
\DoxyCodeLine{00066\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22ab60bca57198bc7c2b7fcdb2578044462}{CMD\_SHOW\_FINISHED\_MESSAGE\_SCREEN}}\ }
\DoxyCodeLine{00067\ \};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00072\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_display_command}{DisplayCommand}}}
\DoxyCodeLine{00073\ \{}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22}{DisplayCommandType}}\ type;\ \textcolor{comment}{//\ Tipo\ do\ comando}}
\DoxyCodeLine{00075\ \ \ String\ text;\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Texto\ associado\ ao\ comando\ (ex:\ nome\ do\ estado,\ texto\ digitado)}}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{bool}\ clearScreen;\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ para\ indicar\ se\ a\ tela\ deve\ ser\ limpa\ antes\ de\ exibir\ o\ conteúdo}}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordtype}{int}\ recipeId;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ID\ da\ receita\ (para\ comandos\ de\ detalhes\ de\ receita)}}
\DoxyCodeLine{00078\ \};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00083\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{_statechart_callback_8h_a37644e123f73897073c779b5fabf5f5b}{ControlCommandType}}}
\DoxyCodeLine{00084\ \{}
\DoxyCodeLine{00085\ \ \ CMD\_START\_RECIPE\_STEP,\ \textcolor{comment}{//\ Inicia\ uma\ nova\ etapa\ da\ receita\ com\ temperatura\ e\ duração\ alvos}}
\DoxyCodeLine{00086\ \ \ CMD\_ABORT\_PROCESS\ \ \ \ \ \ \textcolor{comment}{//\ Aborta\ o\ processo\ de\ cozimento\ em\ andamento}}
\DoxyCodeLine{00087\ \};}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00092\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_control_command}{ControlCommand}}}
\DoxyCodeLine{00093\ \{}
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{_statechart_callback_8h_a37644e123f73897073c779b5fabf5f5b}{ControlCommandType}}\ type;\ \textcolor{comment}{//\ Tipo\ do\ comando}}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{int}\ targetTemperature;\ \ \ \textcolor{comment}{//\ Temperatura\ alvo\ para\ a\ etapa}}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordtype}{int}\ durationMinutes;\ \ \ \ \ \textcolor{comment}{//\ Duração\ da\ etapa\ em\ minutos}}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordtype}{int}\ recipeIndex;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Índice\ da\ receita\ atual}}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordtype}{int}\ stepIndex;\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Índice\ da\ etapa\ atual}}
\DoxyCodeLine{00099\ \};}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \textcolor{comment}{//\ -\/-\/-\/\ ESTRUTURAS\ DE\ DADOS\ PARA\ AS\ RECEITAS\ -\/-\/-\/}}
\DoxyCodeLine{00105\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_recipe_step}{RecipeStep}}}
\DoxyCodeLine{00106\ \{}
\DoxyCodeLine{00107\ \ \ String\ name;\ \ \ \ \ \textcolor{comment}{//\ Nome\ da\ etapa\ (ex:\ "{}Mostura"{},\ "{}Descanso\ de\ Proteína"{})}}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{int}\ temperature;\ \textcolor{comment}{//\ Temperatura\ da\ etapa\ em\ ºC}}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{int}\ duration;\ \ \ \ \textcolor{comment}{//\ Duração\ da\ etapa\ em\ minutos}}
\DoxyCodeLine{00110\ \};}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00115\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_recipe}{Recipe}}}
\DoxyCodeLine{00116\ \{}
\DoxyCodeLine{00117\ \ \ String\ name;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Nome\ da\ receita\ (ex:\ "{}American\ Pale\ Ale"{})}}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordtype}{int}\ numSteps;\ \ \ \ \ \ \ \ \textcolor{comment}{//\ Número\ total\ de\ etapas\ nesta\ receita}}
\DoxyCodeLine{00119\ \ \ \mbox{\hyperlink{struct_recipe_step}{RecipeStep}}\ steps[5];\ \textcolor{comment}{//\ Array\ das\ etapas\ da\ receita\ (limite\ de\ 5\ etapas)}}
\DoxyCodeLine{00120\ \};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00125\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_temperature_data}{TemperatureData}}}
\DoxyCodeLine{00126\ \{}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{float}\ temperature1;\ \textcolor{comment}{//\ Temperatura\ do\ sensor\ 1\ (em\ ºC)}}
\DoxyCodeLine{00128\ \};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00133\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_recipe}{Recipe}}\ \mbox{\hyperlink{_statechart_callback_8h_ad3ce2515c7f488555a34842db649c94d}{recipes}}[]\ =\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{comment}{//\ Receita\ 1:\ American\ Pale\ Ale}}
\DoxyCodeLine{00135\ \ \ \ \ \{\textcolor{stringliteral}{"{}American\ Pale\ Ale"{}},\ 2,\ \{\ \{\textcolor{stringliteral}{"{}Curva\ 1"{}},\ 67,\ 1\},\ \{\textcolor{stringliteral}{"{}Curva\ 2"{}},\ 76,\ 1\}\}\},\ \textcolor{comment}{//\ \{"{}Curva\ 1"{},\ 67,\ 60\},\ \{"{}Curva\ 2"{},\ 76,\ 10\}}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ Receita\ 2:\ Witbier}}
\DoxyCodeLine{00137\ \ \ \ \ \{\textcolor{stringliteral}{"{}Witbier"{}},\ 3,\ \{\{\textcolor{stringliteral}{"{}Curva\ 1"{}},\ 50,\ 15\},\ \{\textcolor{stringliteral}{"{}Curva\ 2"{}},\ 68,\ 60\},\ \{\textcolor{stringliteral}{"{}Curva\ 3"{}},\ 76,\ 10\}\}\},}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{comment}{//\ Receita\ 3:\ Belgian\ Dubbel}}
\DoxyCodeLine{00139\ \ \ \ \ \{\textcolor{stringliteral}{"{}Belgian\ Dubbel"{}},\ 4,\ \{\{\textcolor{stringliteral}{"{}Curva\ 1"{}},\ 52,\ 15\},\ \{\textcolor{stringliteral}{"{}Curva\ 2"{}},\ 64,\ 45\},\ \{\textcolor{stringliteral}{"{}Curva\ 3"{}},\ 72,\ 15\},\ \{\textcolor{stringliteral}{"{}Curva\ 4"{}},\ 76,\ 10\}\}\},}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{//\ Receita\ 4:\ Bohemian\ Pilsen}}
\DoxyCodeLine{00141\ \ \ \ \ \{\textcolor{stringliteral}{"{}Bohemian\ Pilsen"{}},\ 5,\ \{\{\textcolor{stringliteral}{"{}Curva\ 1"{}},\ 45,\ 15\},\ \{\textcolor{stringliteral}{"{}Curva\ 2"{}},\ 52,\ 15\},\ \{\textcolor{stringliteral}{"{}Curva\ 3"{}},\ 63,\ 45\},\ \{\textcolor{stringliteral}{"{}Curva\ 4"{}},\ 72,\ 15\},\ \{\textcolor{stringliteral}{"{}Curva\ 5"{}},\ 76,\ 10\}\}\},}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ Receita\ 5:\ Customizar\ (apenas\ um\ placeholder\ por\ enquanto)}}
\DoxyCodeLine{00143\ \ \ \ \ \{\textcolor{stringliteral}{"{}Customizar"{}},\ 0,\ \{\}\}\ \textcolor{comment}{//\ Sem\ etapas\ definidas\ ainda}}
\DoxyCodeLine{00144\ \};}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ NUM\_RECIPES\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{_statechart_callback_8h_ad3ce2515c7f488555a34842db649c94d}{recipes}})\ /\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{_statechart_callback_8h_ad3ce2515c7f488555a34842db649c94d}{recipes}}[0]);}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \textcolor{comment}{//\ -\/-\/-\/\ FILAS\ GLOBAIS\ -\/-\/-\/}}
\DoxyCodeLine{00149\ \textcolor{keyword}{extern}\ QueueHandle\_t\ xDisplayQueue;\ \textcolor{comment}{//\ Fila\ para\ exibições\ no\ display}}
\DoxyCodeLine{00150\ \textcolor{keyword}{extern}\ QueueHandle\_t\ xControlQueue;\ \textcolor{comment}{//\ Fila\ para\ comandos\ da\ controlTask}}
\DoxyCodeLine{00151\ \textcolor{keyword}{extern}\ QueueHandle\_t\ xSensorQueue;\ \ \textcolor{comment}{//\ Fila\ para\ receber\ dados\ do\ sensor}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00158\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_statechart_callback_a0c1b1d3d630dee0f849b1d0bd94b0c4f}{StatechartCallback}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_statechart_1_1_operation_callback}{Statechart::OperationCallback}}}
\DoxyCodeLine{00159\ \{}
\DoxyCodeLine{00160\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00161\ \ \ \textcolor{comment}{//\ Propriedades\ internas\ para\ estado\ de\ hardware\ e\ UI}}
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{bool}\ oledOK\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ para\ indicar\ se\ o\ display\ OLED\ foi\ inicializado\ com\ sucesso}}
\DoxyCodeLine{00163\ \ \ Keypad\ *keypad\ =\ \textcolor{keyword}{nullptr};\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ponteiro\ para\ o\ objeto\ do\ teclado\ matricial}}
\DoxyCodeLine{00164\ \ \ \textcolor{keywordtype}{bool}\ matrixOK\ =\ \textcolor{keyword}{false};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Flag\ para\ indicar\ se\ o\ teclado\ matricial\ foi\ inicializado\ com\ sucesso}}
\DoxyCodeLine{00165\ \ \ String\ inputBuffer\ =\ \textcolor{stringliteral}{"{}"{}};\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Buffer\ para\ armazenar\ a\ entrada\ digitada\ pelo\ teclado}}
\DoxyCodeLine{00166\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ lastKeyPressTime\ =\ 0;\ \textcolor{comment}{//\ Timestamp\ da\ última\ tecla\ pressionada\ (para\ timeout\ de\ buffer)}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \textcolor{comment}{//\ Variáveis\ para\ controle\ da\ receita\ e\ etapa\ atual\ em\ processamento}}
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ (Inicializadas\ em\ -\/1\ para\ indicar\ que\ nenhuma\ receita\ está\ ativa)}}
\DoxyCodeLine{00170\ \ \ \textcolor{keywordtype}{int}\ currentRecipeIdx\ =\ -\/1;}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordtype}{int}\ currentStepIdx\ =\ -\/1;}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keywordtype}{float}\ lastReadTemperature\ =\ 0.0;\ \textcolor{comment}{//\ Armazena\ a\ última\ temperatura\ lida\ para\ ser\ acessada}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00178\ \ \ \mbox{\hyperlink{class_statechart_callback_a0c1b1d3d630dee0f849b1d0bd94b0c4f}{StatechartCallback}}()\ \{\}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00184\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a71f68e8972a472764d5cf158b397fcf7}{setStatechart}}(\mbox{\hyperlink{class_statechart}{Statechart}}\ *sc)}
\DoxyCodeLine{00185\ \ \ \{}
\DoxyCodeLine{00186\ \ \ \ \ myStatechart\ =\ sc;}
\DoxyCodeLine{00187\ \ \ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ MÉTODOS\ DE\ CALLBACK\ (IMPLEMENTAÇÃO\ DAS\ OPERAÇÕES\ DO\ ITEMIS)\ -\/-\/-\/}}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a6512d1f0ee6b8e4889bb713912a9d846}{beginDisplay}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00195\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00196\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Solicitando\ inicio\ do\ display\ (Display\ Task\ irá\ inicializar)"{}});}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{//\ A\ inicialização\ real\ do\ display\ é\ feita\ na\ displayTask.\ Aqui\ é\ apenas\ um\ debug\ para\ sinalizar\ sucesso}}
\DoxyCodeLine{00198\ \ \ \ \ oledOK\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00199\ \ \ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00207\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a2ca18e895e1180b30e3704de1620f2c4}{pinMode}}(sc\_integer\ pin,\ sc\_integer\ mode)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00208\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00209\ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a2ca18e895e1180b30e3704de1620f2c4}{::pinMode}}(pin,\ mode\ ==\ 1\ ?\ OUTPUT\ :\ INPUT);}
\DoxyCodeLine{00210\ \ \ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00218\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a32d603cc5924d81e7bae26df2a58cdd5}{digitalWrite}}(sc\_integer\ pin,\ sc\_integer\ value)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00219\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00220\ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a32d603cc5924d81e7bae26df2a58cdd5}{::digitalWrite}}(pin,\ value);}
\DoxyCodeLine{00221\ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00227\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a3284e955756a933d45e0bc353478cdb2}{showStartup}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00228\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00229\ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a9b9ccbe68655c10897a3ded78fc3cec8}{CMD\_SHOW\_STARTUP\_MESSAGE}}\};}
\DoxyCodeLine{00230\ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00231\ \ \ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a7312ea56019093e99340f326156ad0ef}{showRecipes}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00238\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00239\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Executando\ showRecipes()\ -\/\ Menu\ de\ Receitas"{}});}
\DoxyCodeLine{00240\ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a38415e178049b3abad6d027af5041cba}{CMD\_SHOW\_RECIPES\_LIST}}\};}
\DoxyCodeLine{00241\ \ \ \ \ cmd.clearScreen\ =\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Sempre\ limpa\ para\ o\ menu\ principal\ de\ receitas}}
\DoxyCodeLine{00242\ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00243\ \ \ \ \ inputBuffer\ =\ \textcolor{stringliteral}{"{}"{}};\ \textcolor{comment}{//\ Limpa\ o\ buffer\ do\ teclado\ para\ a\ nova\ tela}}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00251\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a79ccb2fd5cd9782ae04202fc81a8eb2a}{showRecipe}}(sc\_integer\ recipeId)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00252\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00253\ \ \ \ \ Serial.print(\textcolor{stringliteral}{"{}Callback:\ Executando\ showRecipe()\ para\ receita\ ID:\ "{}});}
\DoxyCodeLine{00254\ \ \ \ \ Serial.println(recipeId);}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordflow}{if}\ (recipeId\ >=\ 1\ \&\&\ recipeId\ <=\ NUM\_RECIPES)}
\DoxyCodeLine{00257\ \ \ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a83c456024f50d58dd3211c82a6760dc9}{CMD\_SHOW\_RECIPE\_DETAILS\_SCREEN}}\};\ \textcolor{comment}{//\ Comando\ para\ detalhes\ da\ receita}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ cmd.recipeId\ =\ recipeId\ -\/\ 1;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ajusta\ para\ índice\ base\ 0\ do\ array\ \`{}recipes`}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ cmd.clearScreen\ =\ \textcolor{keyword}{true};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Sempre\ limpa\ para\ os\ detalhes\ da\ receita}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00262\ \ \ \ \ \}}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00264\ \ \ \ \ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Receita\ inválida\ solicitada."{}});}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ \ \ \ \ inputBuffer\ =\ \textcolor{stringliteral}{"{}"{}};\ \textcolor{comment}{//\ Limpa\ o\ buffer\ do\ teclado\ para\ a\ nova\ tela}}
\DoxyCodeLine{00268\ \ \ \}}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ MÉTODOS\ DE\ CALLBACK\ PARA\ O\ STANDARD\_PROCESS\ -\/-\/-\/}}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a0060eb65c22e39e622d1076448a29e1f}{initializeProcess}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00276\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00277\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Processo\ de\ cozimento\ inicializado."{}});}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00287\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a366ba128bf01272f1d554f43b248b0b5}{startNextRecipeStep}}(sc\_integer\ recipeIndex)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00288\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{comment}{//\ Se\ a\ receita\ mudou\ ou\ é\ o\ início\ do\ processo\ (vinda\ do\ START\_PROCESS)}}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>currentRecipeIdx\ !=\ recipeIndex)}
\DoxyCodeLine{00291\ \ \ \ \ \{}
\DoxyCodeLine{00292\ \ \ \ \ \ \ this-\/>currentRecipeIdx\ =\ recipeIndex;}
\DoxyCodeLine{00293\ \ \ \ \ \ \ this-\/>currentStepIdx\ =\ 0;\ \textcolor{comment}{//\ Começa\ da\ primeira\ etapa}}
\DoxyCodeLine{00294\ \ \ \ \ \}}
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00296\ \ \ \ \ \{}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \textcolor{comment}{//\ Se\ já\ está\ na\ mesma\ receita,\ avança\ para\ a\ próxima\ etapa}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ this-\/>currentStepIdx++;}
\DoxyCodeLine{00299\ \ \ \ \ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>currentRecipeIdx\ >=\ 0\ \&\&\ this-\/>currentRecipeIdx\ <\ NUM\_RECIPES)}
\DoxyCodeLine{00302\ \ \ \ \ \{}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_recipe}{Recipe}}\ \&recipe\ =\ \mbox{\hyperlink{_statechart_callback_8h_ad3ce2515c7f488555a34842db649c94d}{recipes}}[this-\/>currentRecipeIdx];}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this-\/>currentStepIdx\ <\ recipe.numSteps)}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_recipe_step}{RecipeStep}}\ \&step\ =\ recipe.steps[this-\/>currentStepIdx];}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Callback:\ INICIANDO\ ETAPA\ \%d/\%d:\ \%s\ (Temp:\ \%dC,\ Tempo:\ \%dmin)\(\backslash\)n"{}},}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this-\/>currentStepIdx\ +\ 1,\ recipe.numSteps,\ step.name.c\_str(),\ step.temperature,\ step.duration);}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_control_command}{ControlCommand}}\ controlCmd\ =\ \{CMD\_START\_RECIPE\_STEP\};}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ controlCmd.recipeIndex\ =\ this-\/>currentRecipeIdx;}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ controlCmd.stepIndex\ =\ this-\/>currentStepIdx;}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ controlCmd.targetTemperature\ =\ step.temperature;\ \ \ \ \ \ \ \textcolor{comment}{//\ Passa\ a\ temperatura\ alvo}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ controlCmd.durationMinutes\ =\ step.duration;\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Passa\ a\ duração}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ xQueueSend(xControlQueue,\ \&controlCmd,\ portMAX\_DELAY);\ \textcolor{comment}{//\ Envia\ o\ comando\ para\ a\ ControlTask}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Exibe\ o\ status\ inicial\ da\ etapa\ no\ display}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Os\ valores\ de\ temperatura\ atual\ e\ tempo\ restante\ serão\ atualizados\ por\ uma\ tarefa\ de\ controle}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_ada2c780738f608c405b2f5eab33aca79}{showProcessStatus}}(0,\ step.temperature,\ step.duration,\ 0,\ \textcolor{keyword}{const\_cast<}sc\_string\textcolor{keyword}{>}(step.name.c\_str()),\ this-\/>currentStepIdx\ +\ 1,\ recipe.numSteps,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Este\ bloco\ não\ deveria\ ser\ alcançado\ se\ as\ guardas\ do\ Itemis\ estiverem\ corretas}}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Significa\ que\ startNextRecipeStep\ foi\ chamado\ mas\ não\ há\ mais\ etapas}}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Erro\ lógico:\ startNextRecipeStep\ chamada\ sem\ mais\ etapas."{}});}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00327\ \ \ \ \ \}}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00329\ \ \ \ \ \{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Erro:\ Receita\ inválida\ em\ startNextRecipeStep."{}});}
\DoxyCodeLine{00331\ \ \ \ \ \}}
\DoxyCodeLine{00332\ \ \ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00339\ \ \ sc\_boolean\ \mbox{\hyperlink{class_statechart_callback_a0b352beed274ffe9240b759d717daab2}{hasMoreSteps}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00340\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordflow}{if}\ (currentRecipeIdx\ >=\ 0\ \&\&\ currentRecipeIdx\ <\ NUM\_RECIPES)}
\DoxyCodeLine{00342\ \ \ \ \ \{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (currentStepIdx\ +\ 1)\ <\ \mbox{\hyperlink{_statechart_callback_8h_ad3ce2515c7f488555a34842db649c94d}{recipes}}[currentRecipeIdx].numSteps;}
\DoxyCodeLine{00344\ \ \ \ \ \}}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ Se\ não\ houver\ receita\ selecionada\ ou\ etapas\ inválidas,\ não\ há\ mais\ etapas}}
\DoxyCodeLine{00346\ \ \ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00353\ \ \ sc\_integer\ \mbox{\hyperlink{class_statechart_callback_a805b1c8d0c6b7d772ea2352a66c23708}{getCurrentRecipeIndex}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00354\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordflow}{return}\ currentRecipeIdx;}
\DoxyCodeLine{00356\ \ \ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00363\ \ \ sc\_integer\ \mbox{\hyperlink{class_statechart_callback_a569b34e99acca77703710d4504780a70}{getCurrentStepIndex}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00364\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keywordflow}{return}\ currentStepIdx;}
\DoxyCodeLine{00366\ \ \ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00380\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_ada2c780738f608c405b2f5eab33aca79}{showProcessStatus}}(sc\_integer\ currentTemp,\ sc\_integer\ targetTemp,\ sc\_integer\ remainingMinutes,\ sc\_integer\ remainingSeconds,\ sc\_string\ stepName,\ sc\_integer\ stepNum,\ sc\_integer\ totalSteps,\ sc\_boolean\ isRamping)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00381\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00382\ \ \ \ \ \textcolor{comment}{//\ Debug}}
\DoxyCodeLine{00383\ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Callback:\ Status\ Processo:\ Etapa\ \%d/\%d\ '\%s'\ -\/\ Atual:\ \%dC,\ Alvo:\ \%dC.\ Tempo:\ \%d:\%02d\ (Rampa:\ \%s)\(\backslash\)n"{}},}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stepNum,\ totalSteps,\ stepName,\ currentTemp,\ targetTemp,\ remainingMinutes,\ remainingSeconds,\ isRamping\ ?\ \textcolor{stringliteral}{"{}SIM"{}}\ :\ \textcolor{stringliteral}{"{}NAO"{}});}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22ac7e9bde2dc20904ed5ccdae878cdebbb}{CMD\_SHOW\_PROCESS\_STATUS\_SCREEN}}\};}
\DoxyCodeLine{00387\ \ \ \ \ cmd.clearScreen\ =\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Sempre\ limpa\ para\ esta\ tela\ de\ status}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/\ LÓGICA\ DE\ MONTAGEM\ DA\ STRING\ AGORA\ DENTRO\ DESTE\ CALLBACK\ -\/-\/-\/}}
\DoxyCodeLine{00390\ \ \ \ \ String\ statusMessage\_part1\ =\ \textcolor{stringliteral}{"{}Receita:\ "{}}\ +\ \mbox{\hyperlink{_statechart_callback_8h_ad3ce2515c7f488555a34842db649c94d}{recipes}}[currentRecipeIdx].name;}
\DoxyCodeLine{00391\ \ \ \ \ String\ statusMessage\_part2\ =\ \textcolor{stringliteral}{"{}Etapa\ "{}}\ +\ String(stepNum)\ +\ \textcolor{stringliteral}{"{}/"{}}\ +\ String(totalSteps)\ +\ \textcolor{stringliteral}{"{}:\ "{}}\ +\ String(stepName);}
\DoxyCodeLine{00392\ \ \ \ \ String\ statusMessage\_part3;\ \textcolor{comment}{//\ Linha\ da\ temperatura}}
\DoxyCodeLine{00393\ \ \ \ \ String\ statusMessage\_part4;\ \textcolor{comment}{//\ Linha\ do\ tempo\ ou\ rampa}}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{keywordflow}{if}\ (isRamping)}
\DoxyCodeLine{00396\ \ \ \ \ \{\ \textcolor{comment}{//\ Se\ está\ em\ fase\ de\ rampa}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ statusMessage\_part3\ =\ \textcolor{stringliteral}{"{}Rampa:\ "{}}\ +\ String(currentTemp)\ +\ \textcolor{stringliteral}{"{}C\ /\ "{}}\ +\ String(targetTemp)\ +\ \textcolor{stringliteral}{"{}C"{}};}
\DoxyCodeLine{00398\ \ \ \ \ \ \ statusMessage\_part4\ =\ \textcolor{stringliteral}{"{}Aguardando\ Setpoint..."{}};}
\DoxyCodeLine{00399\ \ \ \ \ \}}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00401\ \ \ \ \ \{\ \textcolor{comment}{//\ Se\ atingiu\ o\ setpoint,\ mostra\ temp\ e\ tempo}}
\DoxyCodeLine{00402\ \ \ \ \ \ \ statusMessage\_part3\ =\ \textcolor{stringliteral}{"{}Temp:\ "{}}\ +\ String(currentTemp)\ +\ \textcolor{stringliteral}{"{}C\ /\ "{}}\ +\ String(targetTemp)\ +\ \textcolor{stringliteral}{"{}C"{}};}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ timeBuffer[10];}
\DoxyCodeLine{00404\ \ \ \ \ \ \ sprintf(timeBuffer,\ \textcolor{stringliteral}{"{}\%d\ m\ \%02d\ s"{}},\ remainingMinutes,\ remainingSeconds);}
\DoxyCodeLine{00405\ \ \ \ \ \ \ statusMessage\_part4\ =\ \textcolor{stringliteral}{"{}Tempo:\ "{}}\ +\ String(timeBuffer);}
\DoxyCodeLine{00406\ \ \ \ \ \}}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ cmd.text\ =\ statusMessage\_part1\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ statusMessage\_part2\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ statusMessage\_part3\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ statusMessage\_part4;}
\DoxyCodeLine{00409\ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);\ \textcolor{comment}{//\ Envia\ para\ a\ displayTask}}
\DoxyCodeLine{00410\ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00416\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a52e80be024b7f897449ae5738ac28eb7}{showFinished}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00417\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00418\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Processo\ de\ cozimento\ finalizado.\ Desligando\ atuadores."{}});}
\DoxyCodeLine{00419\ \ \ \ \ \textcolor{comment}{//\ Após\ desligar\ os\ atuadores,\ disparar\ o\ evento\ finished\_process}}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ para\ a\ máquina\ de\ estados\ transitar\ para\ FINISHED\_MESSAGE}}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordflow}{if}\ (myStatechart\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00422\ \ \ \ \ \{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ myStatechart-\/>raiseFinished\_process();}
\DoxyCodeLine{00424\ \ \ \ \ \}}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00426\ \ \ \ \ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Erro:\ myStatechart\ é\ nullptr\ em\ showFinished!"{}});}
\DoxyCodeLine{00428\ \ \ \ \ \}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{comment}{//\ Resetar\ índices\ de\ receita/etapa\ após\ o\ fim\ do\ processo}}
\DoxyCodeLine{00431\ \ \ \ \ currentRecipeIdx\ =\ -\/1;}
\DoxyCodeLine{00432\ \ \ \ \ currentStepIdx\ =\ -\/1;}
\DoxyCodeLine{00433\ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00439\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a6830f5cc9a7625ef7c91a65491ddd5c2}{showFinishedMessage}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00440\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00441\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Exibindo\ mensagem\ 'Receita\ concluída'."{}});}
\DoxyCodeLine{00442\ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22ab60bca57198bc7c2b7fcdb2578044462}{CMD\_SHOW\_FINISHED\_MESSAGE\_SCREEN}}\};}
\DoxyCodeLine{00443\ \ \ \ \ cmd.clearScreen\ =\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Limpa\ a\ tela\ para\ exibir\ a\ mensagem\ final}}
\DoxyCodeLine{00444\ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00445\ \ \ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00452\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a0b153376b4a3d937102602051ac50c80}{showState}}(sc\_string\ state)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00453\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00454\ \ \ \ \ Serial.print(\textcolor{stringliteral}{"{}Callback:\ Estado\ atual:\ "{}});}
\DoxyCodeLine{00455\ \ \ \ \ Serial.println(state);}
\DoxyCodeLine{00456\ \ \ \ \ \textcolor{comment}{//\ Envia\ comando\ para\ a\ displayTask\ para\ mostrar\ o\ nome\ do\ estado}}
\DoxyCodeLine{00457\ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22a3d08f50be96d71a458162333bf33c60f}{CMD\_SHOW\_STATE\_INFO}},\ String(state)\};}
\DoxyCodeLine{00458\ \ \ \ \ cmd.clearScreen\ =\ \textcolor{keyword}{false};\ \textcolor{comment}{//\ Não\ limpa\ a\ tela\ inteira,\ apenas\ a\ linha\ superior\ é\ reescrita}}
\DoxyCodeLine{00459\ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00460\ \ \ \}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00466\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a40d4b821ee479a29fa16d5bb65f60f16}{showIdleScreen}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00467\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00468\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Exibindo\ tela\ de\ IDLE"{}});}
\DoxyCodeLine{00469\ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ cmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22ab45b5c5cd6dcf255514bb199504797e8}{CMD\_SHOW\_MAIN\_MENU\_SCREEN}}\};}
\DoxyCodeLine{00470\ \ \ \ \ cmd.clearScreen\ =\ \textcolor{keyword}{true};\ \textcolor{comment}{//\ Sempre\ limpa\ para\ esta\ tela}}
\DoxyCodeLine{00471\ \ \ \ \ xQueueSend(xDisplayQueue,\ \&cmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00472\ \ \ \}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00478\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a9bec19382c76a6631cbbba5b1c025bed}{beginMatrix}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00479\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00480\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Iniciando\ teclado\ matricial."{}});}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordflow}{if}\ (keypad\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00482\ \ \ \ \ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ keypad\ =\ \textcolor{keyword}{new}\ Keypad(makeKeymap(keys),\ rowPins,\ colPins,\ ROWS,\ COLS);}
\DoxyCodeLine{00484\ \ \ \ \ \}}
\DoxyCodeLine{00485\ \ \ \ \ \textcolor{keywordflow}{if}\ (keypad\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00486\ \ \ \ \ \{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ matrixOK\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00488\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Teclado\ iniciado\ com\ sucesso."{}});}
\DoxyCodeLine{00489\ \ \ \ \ \}}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00491\ \ \ \ \ \{}
\DoxyCodeLine{00492\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Falha\ ao\ iniciar\ teclado."{}});}
\DoxyCodeLine{00493\ \ \ \ \ \ \ matrixOK\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00494\ \ \ \ \ \}}
\DoxyCodeLine{00495\ \ \ \}}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ FUNÇÕES\ AUXILIARES\ PARA\ GERENCIAMENTO\ DE\ ENTRADA\ DO\ TECLADO\ E\ DISPLAY\ -\/-\/-\/}}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{class_statechart_callback_accdea45556fad26adb2a7714d5c69c7d}{readKeypadChar}}()}
\DoxyCodeLine{00504\ \ \ \{}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordflow}{if}\ (matrixOK\ \&\&\ keypad\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00506\ \ \ \ \ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ keypad-\/>getKey();}
\DoxyCodeLine{00508\ \ \ \ \ \}}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordflow}{return}\ NO\_KEY;}
\DoxyCodeLine{00510\ \ \ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00516\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a9b0bc6caa3dadb23e26d8c77a19196df}{printKeypadInput}}()}
\DoxyCodeLine{00517\ \ \ \{}
\DoxyCodeLine{00518\ \ \ \ \ \textcolor{keywordflow}{if}\ (inputBuffer.length()\ >\ 0)}
\DoxyCodeLine{00519\ \ \ \ \ \{}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \mbox{\hyperlink{struct_display_command}{DisplayCommand}}\ printCmd\ =\ \{\mbox{\hyperlink{_statechart_callback_8h_a44948d591f0564ddb54a1b8c392a6a22aee41de1a1b27e052cb15e5cc762b14e8}{CMD\_PRINT\_KEYPAD\_INPUT}},\ \textcolor{stringliteral}{"{}Digitado:\ "{}}\ +\ inputBuffer\};}
\DoxyCodeLine{00521\ \ \ \ \ \ \ xQueueSend(xDisplayQueue,\ \&printCmd,\ portMAX\_DELAY);}
\DoxyCodeLine{00522\ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \}}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ SEMÁFORO\ -\/-\/-\/}}
\DoxyCodeLine{00530\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a244c879e69bb717bcc87c9970b988bc5}{beginSemaphore}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00531\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00532\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Inicializando\ pinos\ do\ semáforo."{}});}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{keywordflow}{if}\ (myStatechart\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00535\ \ \ \ \ \{}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \textcolor{comment}{//\ Obter\ os\ valores\ dos\ pinos\ e\ modo\ de\ saída\ definidos\ no\ Itemis}}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ redPin\ =\ myStatechart-\/>getSemaphore\_red\_pin();}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ yellowPin\ =\ myStatechart-\/>getSemaphore\_yellow\_pin();}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ greenPin\ =\ myStatechart-\/>getSemaphore\_green\_pin();}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ outputMode\ =\ myStatechart-\/>getOutput();\ \textcolor{comment}{//\ Obter\ o\ valor\ de\ 'output'\ (1)}}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ lowValue\ =\ myStatechart-\/>getLow();\ \ \ \ \ \ \textcolor{comment}{//\ Obter\ o\ valor\ de\ 'low'\ (0)}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \ \ \textcolor{comment}{//\ CHAMAR\ AS\ IMPLEMENTAÇÕES\ DOS\ MÉTODOS\ DE\ CALLBACK\ DIRETAMENTE}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \textcolor{comment}{//\ vai\ ser\ usado\ as\ implementações\ de\ ::pinMode\ e\ ::digitalWrite}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a2ca18e895e1180b30e3704de1620f2c4}{pinMode}}(redPin,\ outputMode);}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a2ca18e895e1180b30e3704de1620f2c4}{pinMode}}(yellowPin,\ outputMode);}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a2ca18e895e1180b30e3704de1620f2c4}{pinMode}}(greenPin,\ outputMode);}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \ \ \ \ \ \ \textcolor{comment}{//\ E\ desligue\ todos\ os\ LEDs\ inicialmente\ para\ garantir\ um\ estado\ conhecido}}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a32d603cc5924d81e7bae26df2a58cdd5}{digitalWrite}}(redPin,\ lowValue);}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a32d603cc5924d81e7bae26df2a58cdd5}{digitalWrite}}(yellowPin,\ lowValue);}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a32d603cc5924d81e7bae26df2a58cdd5}{digitalWrite}}(greenPin,\ lowValue);}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Callback:\ Semaforo\ R:\%d\ Y:\%d\ G:\%d\ configurados\ como\ OUTPUT\ e\ desligados.\(\backslash\)n"{}},\ redPin,\ yellowPin,\ greenPin);}
\DoxyCodeLine{00555\ \ \ \ \ \}}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00557\ \ \ \ \ \{}
\DoxyCodeLine{00558\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ ERRO:\ myStatechart\ e\ nullptr\ ao\ inicializar\ semaforo."{}});}
\DoxyCodeLine{00559\ \ \ \ \ \}}
\DoxyCodeLine{00560\ \ \ \}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ MÉTODO\ DE\ CALLBACK\ PARA\ CONTROLE\ DO\ AQUECEDOR\ PWM\ -\/-\/-\/}}
\DoxyCodeLine{00567\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a991e9ac6e43b6990de74162c38277efc}{setupHeaterPWM}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00568\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00569\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ Configurando\ PWM\ do\ aquecedor."{}});}
\DoxyCodeLine{00570\ \ \ \ \ \textcolor{keywordflow}{if}\ (myStatechart\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00571\ \ \ \ \ \{}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ heaterPin\ =\ myStatechart-\/>getHeater\_pwm\_pin();\ \ \ \ \ \ \ \textcolor{comment}{//\ Pego\ do\ Itemis}}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pwmFreq\ =\ myStatechart-\/>getPwm\_frequency();\ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Pego\ do\ Itemis}}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pwmResBits\ =\ myStatechart-\/>getPwm\_resolution\_bits();\ \textcolor{comment}{//\ Pego\ do\ Itemis}}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \ \ \ \ \ \ \textcolor{comment}{//\ Configura\ o\ timer\ LEDC\ do\ ESP32}}
\DoxyCodeLine{00577\ \ \ \ \ \ \ ledcSetup(LEDC\_CHANNEL\_PWM\_HEATER,\ pwmFreq,\ pwmResBits);}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \textcolor{comment}{//\ Anexa\ o\ pino\ ao\ canal\ PWM}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ ledcAttachPin(heaterPin,\ LEDC\_CHANNEL\_PWM\_HEATER);}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \textcolor{comment}{//\ Garante\ que\ o\ PWM\ começa\ desligado\ (0\%\ duty\ cycle)}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ ledcWrite(LEDC\_CHANNEL\_PWM\_HEATER,\ 0);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Callback:\ PWM\ do\ aquecedor\ configurado\ no\ GPIO\%d\ (Freq:\ \%dHz,\ Res:\ \%d\ bits).\ Canal\ \%d.\(\backslash\)n"{}},}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ heaterPin,\ pwmFreq,\ pwmResBits,\ LEDC\_CHANNEL\_PWM\_HEATER);}
\DoxyCodeLine{00585\ \ \ \ \ \}}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00587\ \ \ \ \ \{}
\DoxyCodeLine{00588\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ ERRO:\ myStatechart\ é\ nullptr\ ao\ configurar\ PWM\ do\ aquecedor."{}});}
\DoxyCodeLine{00589\ \ \ \ \ \}}
\DoxyCodeLine{00590\ \ \ \}}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00597\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a275fd2a117f0fa221e75cabd98aa53f1}{controlHeaterPWM}}(sc\_integer\ duty\_cycle)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00598\ \textcolor{keyword}{\ \ }\{\ \textcolor{comment}{//\ Nova\ operação\ para\ controlar\ o\ PWM\ diretamente}}
\DoxyCodeLine{00599\ \ \ \ \ ledcWrite(LEDC\_CHANNEL\_PWM\_HEATER,\ duty\_cycle);}
\DoxyCodeLine{00600\ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Callback:\ PWM\ Aquecedor\ -\/\ Duty\ Cycle:\ \%d\(\backslash\)n"{}},\ duty\_cycle);}
\DoxyCodeLine{00601\ \ \ \}}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00608\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a50763df935fa54557772578384635977}{heat}}(sc\_integer\ target\_temp)\textcolor{keyword}{\ override}}
\DoxyCodeLine{00609\ \textcolor{keyword}{\ \ }\{\ \textcolor{comment}{//\ Implementação\ da\ operação\ 'heat'\ do\ Itemis}}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{keywordflow}{if}\ (myStatechart\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00611\ \ \ \ \ \{}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ minTemp\ =\ 25;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Temperatura\ mínima\ que\ o\ PWM\ representa\ 0\%}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ maxTemp\ =\ 100;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Temperatura\ máxima\ que\ o\ PWM\ representa\ 100\%}}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ maxDutyCycle\ =\ (1\ <<\ myStatechart-\/>getPwm\_resolution\_bits())\ -\/\ 1;\ \textcolor{comment}{//\ Ex:\ 1023\ para\ 10\ bits}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ dutyCycle\_calculated\ =\ 0;}
\DoxyCodeLine{00617\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (target\_temp\ <=\ minTemp)}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ dutyCycle\_calculated\ =\ 0;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\_temp\ >=\ maxTemp)}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ dutyCycle\_calculated\ =\ maxDutyCycle;}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Mapeamento\ linear:\ duty\ =\ (target\ -\/\ min)\ /\ (max\ -\/\ min)\ *\ maxDuty}}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ dutyCycle\_calculated\ =\ map(target\_temp,\ minTemp,\ maxTemp,\ 0,\ maxDutyCycle);}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ \ \ \ \ \ \ \mbox{\hyperlink{class_statechart_callback_a275fd2a117f0fa221e75cabd98aa53f1}{controlHeaterPWM}}(dutyCycle\_calculated);\ \textcolor{comment}{//\ Chamar\ a\ função\ de\ controle\ de\ PWM\ diretamente}}
\DoxyCodeLine{00632\ \ \ \ \ \ \ Serial.printf(\textcolor{stringliteral}{"{}Callback:\ Operacao\ 'heat'\ chamada.\ Alvo\ Temp:\ \%dC\ -\/>\ PWM\ Duty\ Calculado:\ \%d\ (max\ \%d)\(\backslash\)n"{}},\ target\_temp,\ dutyCycle\_calculated,\ maxDutyCycle);}
\DoxyCodeLine{00633\ \ \ \ \ \}}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00635\ \ \ \ \ \{}
\DoxyCodeLine{00636\ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ ERRO:\ myStatechart\ é\ nullptr\ em\ heat()."{}});}
\DoxyCodeLine{00637\ \ \ \ \ \}}
\DoxyCodeLine{00638\ \ \ \}}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ MÉTODO\ DE\ CALLBACK\ PARA\ O\ SENSOR\ DE\ ÁGUA\ -\/-\/-\/}}
\DoxyCodeLine{00645\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_statechart_callback_a44358dc04ef8676039de3189deffc315}{beginWaterSensor}}()\textcolor{keyword}{\ override}}
\DoxyCodeLine{00646\ \textcolor{keyword}{\ \ }\{}
\DoxyCodeLine{00647\ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}Callback:\ beginWaterSensor()\ chamado,\ mas\ nao\ inicializa\ mais\ sensor\ 1-\/Wire."{}});}
\DoxyCodeLine{00648\ \ \ \ \ \textcolor{comment}{//\ A\ inicialização\ do\ I2C\ Master\ é\ feita\ no\ setup()\ do\ main.cpp}}
\DoxyCodeLine{00649\ \ \ \ \ \textcolor{comment}{//\ Nenhuma\ ação\ específica\ aqui\ para\ o\ sensor\ de\ temperatura\ simulado\ via\ I2C}}
\DoxyCodeLine{00650\ \ \ \}}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ MÉTODOS\ DE\ CALLBACK\ PARA\ FUNÇÕES\ AINDA\ NÃO\ IMPLEMENTADAS\ OU\ SIMPLES\ -\/-\/-\/}}
\DoxyCodeLine{00653\ \ \ \textcolor{keywordtype}{void}\ shutdownSystem()\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00654\ \ \ \textcolor{keywordtype}{void}\ time(sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00655\ \ \ \textcolor{keywordtype}{void}\ setTemperature(sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00656\ \ \ \textcolor{keywordtype}{void}\ setTime(sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordtype}{void}\ initializeSetupProcess()\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \textcolor{comment}{//\ -\/-\/-\/\ MÉTODOS\ DE\ CUSTOMIZAÇÃO\ (TBD)\ -\/-\/-\/}}
\DoxyCodeLine{00660\ \ \ \textcolor{keywordtype}{void}\ showCustomSetup\_GetNumSteps()\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00661\ \ \ sc\_boolean\ isValidNumSteps(sc\_integer)\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00662\ \ \ \textcolor{keywordtype}{void}\ setNumCustomSteps(sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00663\ \ \ \textcolor{keywordtype}{void}\ initializeStepDataCollection()\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00664\ \ \ \textcolor{keywordtype}{void}\ showCustomSetup\_PromptTemp(sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00665\ \ \ \textcolor{keywordtype}{void}\ showCustomSetup\_PromptTime(sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00666\ \ \ sc\_boolean\ isValidDataInput(sc\_integer)\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00667\ \ \ \textcolor{keywordtype}{void}\ processTemperature(sc\_integer,\ sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00668\ \ \ \textcolor{keywordtype}{void}\ processDuration(sc\_integer,\ sc\_integer)\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00669\ \ \ sc\_boolean\ hasMoreStepsToDefine()\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};\ \}}
\DoxyCodeLine{00670\ \ \ \textcolor{keywordtype}{void}\ advanceToNextCustomStep()\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00671\ \ \ \textcolor{keywordtype}{void}\ showCustomSetup\_Summary()\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00674\ \ \ Statechart\ *myStatechart\ =\ \textcolor{keyword}{nullptr};\ \textcolor{comment}{//\ Ponteiro\ para\ a\ instância\ da\ Statechart}}
\DoxyCodeLine{00675\ \};}
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00677\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ STATECHARTCALLBACK\_H}}

\end{DoxyCode}
